---
layout: post
title: SQL Server BCP
date: '2008-02-01T18:18:00.000Z'
author: SÃ©rgio Agostinho
tags:
- ".Net"
- XML
- SQL Server
modified_time: '2015-05-13T22:22:00.093+01:00'
thumbnail: http://bp1.blogger.com/_5-2Aoc42tHI/R6NjOOlwsrI/AAAAAAAAAHc/PCS1mk-dKdM/s72-c/sqlserverprogramming.jpg
blogger_id: tag:blogger.com,1999:blog-6105644668642718046.post-2746232880099396912
blogger_orig_url: http://sergioagostinho-dev.blogspot.com/2008/02/sql-server-bcp.html
---

A couple of weeks ago I was writing a small application to perform some <a href="http://en.wikipedia.org/wiki/Extract%2C_transform%2C_load">ETL</a> (Extract, Transform, Load) operations. As I was researching an efficient way to perform a large number of SQL insert statements, I found out about the <a href="http://msdn2.microsoft.com/en-us/library/ms162802.aspx">BCP</a> (Bulk CoPy) utility for MS SQL Server. This tool performs efficient data insertion (something in the order of thousands of row inserts per second), using as source CSV (Comma Separated Values) files. The mapping is performed through configuration files in a semi-structured format, or using an <a href="http://technet.microsoft.com/en-us/library/ms189327.aspx">XML file</a> (the latter is strongly recommended). Basically, the trick resides that unlike in regular inserts, database restrictions (primary keys, foreign keys, unique restrictions, null values, etc.) are not enforced for each row, but only at the end of the introduction, or per each block.<br /><br />This was good solution for my needs at the time, which was to extract a large number of data from CSV files into a small number of tables, on a secondary database to the system in question. Of course, the mapping is limited: you cannot perform <a href="http://en.wikipedia.org/wiki/Database_normalization">data normalization</a>, only insert/remove columns, or switch its order. This means that either the input data is normalized, or you end up with a denormalized database. In sum, BCP does not replace an ETL tool, but provides an interesting complement in the "Loading" part.<br /><br />By the way, a very nice book on the subject is <a href="http://www.wrox.com/WileyCDA/WroxTitle/productCd-0764584340,descCd-description.html">Professional SQL Server 2005 Programming</a>, by Robert Vieira, published by <a href="http://www.wrox.com/WileyCDA/">Wrox</a>.<br /><br /><a href="http://bp1.blogger.com/_5-2Aoc42tHI/R6NjOOlwsrI/AAAAAAAAAHc/PCS1mk-dKdM/s1600-h/sqlserverprogramming.jpg" onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}"><img alt="" border="0" id="BLOGGER_PHOTO_ID_5162078693982515890" src="http://bp1.blogger.com/_5-2Aoc42tHI/R6NjOOlwsrI/AAAAAAAAAHc/PCS1mk-dKdM/s200/sqlserverprogramming.jpg" style="cursor: pointer; display: block; margin: 0px auto 10px; text-align: center;" /></a><br /><br />Until next time, may you enjoy bulk copying.